# @r0ss1n1
# SMBv1 SMB_COM_NEGOTIATE
# Charles Thomas Wallace Truscott
import socket

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:

    host = "127.0.0.1"
    port = 445

    s.connect((host, port))
    s.sendall(b'\x00\x00\x00\x45\xff\x53\x4d\x42\x72\x00\x00\x00\x00\x18\x53\xc8\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xfe\x00\x00\x00\x00\x00\x22\x00\x02\x4e\x54\x20\x4c\x4d\x20\x30\x2e\x31\x32\x00\x02\x53\x4d\x42\x20\x32\x2e\x30\x30\x32\x00\x02\x53\x4d\x42\x20\x32\x2e\x3f\x3f\x3f\x00')
    print(str(s.recv(4096), 'utf-8'))